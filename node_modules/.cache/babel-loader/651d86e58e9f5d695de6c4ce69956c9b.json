{"ast":null,"code":"// All the redux actions that relate to the user and authentication\nimport { LOGIN_USER, LOGOUT_USER, ACTION_SUCCESS, FETCH_ERROR, CLEAR_MESSAGE } from './types';\nexport function loginUser(user) {\n  return {\n    type: LOGIN_USER,\n    user\n  };\n}\nexport function logoutUser() {\n  return {\n    type: LOGOUT_USER\n  };\n}\nexport function currentUser(history) {\n  return dispatch => {\n    const token = localStorage.token;\n    const reqObj = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \".concat(token)\n      }\n    }; // dispatch with \"loading\" current user\n\n    return fetch(\"http://localhost:3000/api/v1/current_user\", reqObj).then(resp => resp.json()).then(data => {\n      if (data.error) {\n        //handle error\n        history.push(\"/\");\n        console.log(\"current user\", data.error);\n      } else {\n        dispatch(loginUser({\n          user: data.user\n        }));\n      }\n    });\n  };\n} // ? testing\n\nexport function loadUser(loadingCb, successCb, failCb) {\n  return function (dispatch) {\n    loadingCb();\n    const token = localStorage.token;\n    const reqObj = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \".concat(token)\n      }\n    };\n    return fetch(\"http://localhost:3000/api/v1/current_user\", reqObj).then(resp => resp.json()).then(data => {\n      console.log(data);\n      dispatch({\n        type: ACTION_SUCCESS,\n        user: data\n      });\n      successCb();\n    }).catch(err => {\n      failCb();\n    });\n  };\n}\nexport function login(formData, history) {\n  return dispatch => {\n    const reqObj = {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(formData)\n    };\n    return fetch(\"http://localhost:3000/api/v1/login\", reqObj).then(resp => resp.json()).then(data => {\n      if (data.message) {\n        //handle error case\n        dispatch({\n          type: \"FETCH_ERROR\",\n          error: data.message\n        });\n      } else {\n        console.log(\"fetch login\", data);\n        localStorage.token = data.token; // dispatch(loginUser({ user: data.user }));\n\n        dispatch(loginUser({\n          user: data.user\n        }));\n        dispatch({\n          type: CLEAR_MESSAGE\n        });\n        history.push(\"/\");\n      }\n    }).catch(err => console.log(err));\n  };\n}\nexport function registerUser(formData, history) {\n  return dispatch => {\n    const reqObj = {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(formData)\n    };\n    return fetch(\"http://localhost:3000/api/v1/auth\", reqObj).then(resp => resp.json()).then(data => {\n      if (data.error) {\n        //handle error case\n        console.log(data.error);\n        dispatch({\n          type: FETCH_ERROR,\n          error: data.error\n        });\n      } else {\n        localStorage.token = data.token;\n        dispatch(loginUser(data.user));\n        history.push(\"/\");\n      }\n    });\n  };\n} // ! FUNCTION IS FINISHED YET (29/SEP)\n\nexport function updateUser(formData, history) {\n  return dispatch => {\n    const reqObj = {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(formData)\n    };\n    return fetch(\"http://localhost:3000/api/v1/auth\", reqObj).then(resp => resp.json()).then(data => {\n      if (data.error) {\n        //handle error case\n        console.log(data.error);\n      } else {\n        localStorage.token = data.token;\n        dispatch(loginUser(data.user));\n        history.push(\"/profile\");\n      }\n    });\n  };\n}","map":{"version":3,"sources":["/Users/gracetan/Development/module-projects/module-five-project/project-prospect-frontend/src/actions/auth.js"],"names":["LOGIN_USER","LOGOUT_USER","ACTION_SUCCESS","FETCH_ERROR","CLEAR_MESSAGE","loginUser","user","type","logoutUser","currentUser","history","dispatch","token","localStorage","reqObj","method","headers","Authorization","fetch","then","resp","json","data","error","push","console","log","loadUser","loadingCb","successCb","failCb","catch","err","login","formData","body","JSON","stringify","message","registerUser","updateUser"],"mappings":"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","sourcesContent":["// All the redux actions that relate to the user and authentication\n\nimport { LOGIN_USER, LOGOUT_USER, ACTION_SUCCESS, FETCH_ERROR, CLEAR_MESSAGE } from './types'\n\nexport function loginUser(user) {\n  return {\n    type: LOGIN_USER,\n    user\n  };\n}\n\nexport function logoutUser() {\n  return {\n    type: LOGOUT_USER\n  };\n}\n\nexport function currentUser(history) {\n  return dispatch => {\n    const token = localStorage.token;\n    const reqObj = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`\n      }\n    };\n\n    // dispatch with \"loading\" current user\n\n    return fetch(\"http://localhost:3000/api/v1/current_user\", reqObj)\n      .then(resp => resp.json())\n      .then(data => {\n        if (data.error) {\n          //handle error\n          history.push(\"/\");\n          console.log(\"current user\", data.error);\n        } else {\n          dispatch(loginUser({ user: data.user }));\n        }\n      });\n  };\n}\n\n// ? testing\nexport function loadUser(loadingCb, successCb, failCb) {\n  return function(dispatch) {\n    loadingCb();\n    const token = localStorage.token;\n    const reqObj = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`\n      }\n    };\n\n    return fetch(\"http://localhost:3000/api/v1/current_user\", reqObj)\n      .then(resp => resp.json())\n      .then(data => {\n        console.log(data)\n        dispatch({ type: ACTION_SUCCESS, user: data });\n        successCb();\n      })\n      .catch(err => {\n        failCb();\n      });\n  };\n}\n\nexport function login(formData, history) {\n  return dispatch => {\n    const reqObj = {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(formData)\n    };\n\n    return fetch(\"http://localhost:3000/api/v1/login\", reqObj)\n      .then(resp => resp.json())\n      .then(data => {\n        if (data.message) {\n          //handle error case\n          dispatch({ type: \"FETCH_ERROR\", error: data.message });\n        } else {\n          console.log(\"fetch login\", data);\n          localStorage.token = data.token;\n          // dispatch(loginUser({ user: data.user }));\n          dispatch(loginUser({ user: data.user }))\n          dispatch({ type: CLEAR_MESSAGE });\n          history.push(\"/\");\n        }\n      })\n      .catch(err => console.log(err));\n  };\n}\n\nexport function registerUser(formData, history) {\n  return dispatch => {\n    const reqObj = {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(formData)\n    };\n\n    return fetch(\"http://localhost:3000/api/v1/auth\", reqObj)\n      .then(resp => resp.json())\n      .then(data => {\n        if (data.error) {\n          //handle error case\n          console.log(data.error)\n          dispatch({type: FETCH_ERROR, error: data.error})\n        } else {\n          localStorage.token = data.token;\n          dispatch(loginUser(data.user));\n          history.push(\"/\");\n        }\n      });\n  };\n}\n\n\n// ! FUNCTION IS FINISHED YET (29/SEP)\nexport function updateUser(formData, history) {\n  return dispatch => {\n    const reqObj = {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(formData)\n    };\n\n    return fetch(\"http://localhost:3000/api/v1/auth\", reqObj)\n      .then(resp => resp.json())\n      .then(data => {\n        if (data.error) {\n          //handle error case\n          console.log(data.error);\n        } else {\n          localStorage.token = data.token;\n          dispatch(loginUser(data.user));\n          history.push(\"/profile\");\n        }\n      });\n  };\n}"]},"metadata":{},"sourceType":"module"}