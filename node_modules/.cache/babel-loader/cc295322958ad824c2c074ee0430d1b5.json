{"ast":null,"code":"var fs = require('fs');\n\nvar async = require('async');\n\nvar request = require('request-json');\n\nvar calls = require('./calls');\n\nfunction SDK(key, version, host) {\n  var clientBaseUrl = 'https://api.hunter.io' + '/' + (version || 'v2') + '/';\n  this.client = request.createClient(clientBaseUrl);\n  this.key = key;\n}\n\nObject.keys(calls).forEach(function (call) {\n  var def = calls[call];\n\n  SDK.prototype[call] = function () {\n    var args = [].slice.call(arguments);\n    var params = def.params || [];\n    var namedArgs = args.splice(0, params.length);\n    var path = params.reduce(function (prev, key, index) {\n      return prev.replace('{' + key + '}', namedArgs[index]);\n    }, def.path);\n    var queryParamHash = args.shift();\n    path += Object.keys(queryParamHash).reduce(function (str, key) {\n      return str + '&' + key + '=' + encodeURIComponent(queryParamHash[key]);\n    }, '?api_key=' + this.key);\n    var clientArgs = [path];\n\n    if (def.method === 'post' || def.method === 'put' || def.method === 'patch') {\n      clientArgs.push(args.shift());\n    }\n\n    var callback = args.shift();\n    clientArgs.push(function (err, res, body) {\n      if (err) {\n        return callback(err, null);\n      }\n\n      callback(null, body, res);\n    });\n    this.client[def.method].apply(this.client, clientArgs);\n  };\n});\nmodule.exports = SDK;","map":null,"metadata":{},"sourceType":"script"}