{"ast":null,"code":"// All redux functions that relate to leads\nimport { FETCH_LEADS, START_FETCH_LEADS, START_FETCH_LEADS_AND_LIST, SUCCESS_MESSAGE, ADD_LIST, ADD_METRIC_LEADS } from './types';\n\nconst uuidv1 = require(\"uuid/v1\");\n\nexport function thunkFetchLeads(domainName, history) {\n  return function (dispatch) {\n    dispatch({\n      type: START_FETCH_LEADS\n    });\n    fetch(\"https://api.hunter.io/v2/domain-search?domain=\".concat(domainName, \"&limit=100&api_key=7ca084937e5e049696b7bb64c10366c3d077c650\")).then(res => res.json()).then(result => {\n      dispatch({\n        type: FETCH_LEADS,\n        id: uuidv1(),\n        leads: result.data\n      });\n      history.push(\"/results\");\n    });\n  };\n} // ? creating a new lead instance of the one the user saved and creating the association between list and lead\n\nexport function addLead(leadsArray, company, website, listId, newListName, userId) {\n  return function (dispatch) {\n    // const token = localStorage.token;\n    dispatch({\n      type: START_FETCH_LEADS_AND_LIST\n    });\n    fetch(\"https://frozen-shore-20550.herokuapp.com/api/v1/leads\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\"\n      },\n      body: JSON.stringify({\n        leadsArray,\n        company: company,\n        website: website\n      })\n    }).then(res => res.json()).then(data => {\n      const leadsData = data;\n\n      if (listId) {\n        data.forEach(lead => {\n          fetch(\"https://frozen-shore-20550.herokuapp.com/api/v1/leadlists\", {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\",\n              Accept: \"application/json\"\n            },\n            body: JSON.stringify({\n              list_id: listId,\n              lead_id: lead.id\n            })\n          }).then(res => res.json()).then(data => {\n            dispatch({\n              type: SUCCESS_MESSAGE,\n              message: data.message\n            });\n          }).catch(err => console.log(err));\n        });\n      } else {\n        fetch(\"https://frozen-shore-20550.herokuapp.com/api/v1/lists\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Accept: \"application/json\"\n          },\n          body: JSON.stringify({\n            name: newListName,\n            user_id: userId\n          })\n        }).then(res => res.json()).then(data => {\n          dispatch({\n            type: ADD_LIST,\n            list: data\n          });\n          leadsData.forEach(lead => {\n            fetch(\"https://frozen-shore-20550.herokuapp.com/api/v1/leadlists\", {\n              method: \"POST\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Accept: \"application/json\"\n              },\n              body: JSON.stringify({\n                list_id: data.id,\n                lead_id: lead.id\n              })\n            }) // end of the fetch\n            .then(res => res.json()).then(data => {\n              dispatch({\n                type: SUCCESS_MESSAGE,\n                message: data.message\n              });\n            }).catch(err => console.log(err));\n          });\n        }).catch(err => console.log(err));\n      }\n    }).catch(err => console.log(err));\n  };\n}\nexport function metricLeads(leads, history, title) {\n  return function (dispatch) {\n    dispatch({\n      type: ADD_METRIC_LEADS,\n      leads,\n      title\n    });\n    history.push('/detailed');\n  };\n}","map":{"version":3,"sources":["/Users/gracetan/Development/module-projects/module-five-project/project-prospect-frontend/src/actions/leads.js"],"names":["FETCH_LEADS","START_FETCH_LEADS","START_FETCH_LEADS_AND_LIST","SUCCESS_MESSAGE","ADD_LIST","ADD_METRIC_LEADS","uuidv1","require","thunkFetchLeads","domainName","history","dispatch","type","fetch","then","res","json","result","id","leads","data","push","addLead","leadsArray","company","website","listId","newListName","userId","method","headers","Accept","body","JSON","stringify","leadsData","forEach","lead","list_id","lead_id","message","catch","err","console","log","name","user_id","list","metricLeads","title"],"mappings":"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","sourcesContent":["// All redux functions that relate to leads\n\nimport { FETCH_LEADS, START_FETCH_LEADS, START_FETCH_LEADS_AND_LIST, SUCCESS_MESSAGE, ADD_LIST, ADD_METRIC_LEADS } from './types'\n\nconst uuidv1 = require(\"uuid/v1\");\n\n\nexport function thunkFetchLeads(domainName, history) {\n  return function(dispatch) {\n    dispatch({ type: START_FETCH_LEADS });\n\n    fetch(\n      `https://api.hunter.io/v2/domain-search?domain=${domainName}&limit=100&api_key=7ca084937e5e049696b7bb64c10366c3d077c650`\n    )\n      .then(res => res.json())\n      .then(result => {\n        dispatch({ type: FETCH_LEADS, id: uuidv1(), leads: result.data });\n        history.push(\"/results\");\n      });\n  };\n}\n\n// ? creating a new lead instance of the one the user saved and creating the association between list and lead\nexport function addLead(\n  leadsArray,\n  company,\n  website,\n  listId,\n  newListName,\n  userId\n) {\n  return function(dispatch) {\n    // const token = localStorage.token;\n    dispatch({ type: START_FETCH_LEADS_AND_LIST });\n\n    fetch(\"https://frozen-shore-20550.herokuapp.com/api/v1/leads\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\"\n      },\n      body: JSON.stringify({\n        leadsArray,\n        company: company,\n        website: website\n      })\n    })\n      .then(res => res.json())\n      .then(data => {\n        const leadsData = data;\n        if (listId) {\n          data.forEach(lead => {\n            fetch(\"https://frozen-shore-20550.herokuapp.com/api/v1/leadlists\", {\n              method: \"POST\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Accept: \"application/json\"\n              },\n              body: JSON.stringify({\n                list_id: listId,\n                lead_id: lead.id\n              })\n            })\n              .then(res => res.json())\n              .then(data => {\n                dispatch({ type: SUCCESS_MESSAGE, message: data.message });\n              })\n              .catch(err => console.log(err));\n          });\n        } else {\n          fetch(\"https://frozen-shore-20550.herokuapp.com/api/v1/lists\", {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\",\n              Accept: \"application/json\"\n            },\n            body: JSON.stringify({\n              name: newListName,\n              user_id: userId\n            })\n          })\n            .then(res => res.json())\n            .then(data => {\n              dispatch({ type: ADD_LIST, list: data });\n              leadsData.forEach(lead => {\n                fetch(\"https://frozen-shore-20550.herokuapp.com/api/v1/leadlists\", {\n                  method: \"POST\",\n                  headers: {\n                    \"Content-Type\": \"application/json\",\n                    Accept: \"application/json\"\n                  },\n                  body: JSON.stringify({\n                    list_id: data.id,\n                    lead_id: lead.id\n                  })\n                }) // end of the fetch\n                  .then(res => res.json())\n                  .then(data => {\n                    dispatch({ type: SUCCESS_MESSAGE, message: data.message });\n                  })\n                  .catch(err => console.log(err));\n              });\n            })\n            .catch(err => console.log(err));\n        }\n      })\n      .catch(err => console.log(err));\n  };\n}\n\nexport function metricLeads(leads, history, title) {\n  return function(dispatch) {\n    dispatch({type: ADD_METRIC_LEADS, leads, title})\n      history.push('/detailed')\n  }\n}\n"]},"metadata":{},"sourceType":"module"}