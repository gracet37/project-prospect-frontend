{"ast":null,"code":"var reIpv4FirstPass = /^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$/;\nvar reSubnetString = /\\/\\d{1,3}(?=%|$)/;\nvar reForwardSlash = /\\//;\nvar reZone = /%.*$/;\nvar reBadCharacters = /([^0-9a-f:/%])/i;\nvar reBadAddress = /([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\\/$)/i;\n\nfunction validate4(input) {\n  if (!reIpv4FirstPass.test(input)) return false;\n  var parts = input.split('.');\n  if (parts.length !== 4) return false;\n  if (parts[0][0] === '0' && parts[0].length > 1) return false;\n  if (parts[1][0] === '0' && parts[1].length > 1) return false;\n  if (parts[2][0] === '0' && parts[2].length > 1) return false;\n  if (parts[3][0] === '0' && parts[3].length > 1) return false;\n  var n0 = Number(parts[0]);\n  var n1 = Number(parts[1]);\n  var n2 = Number(parts[2]);\n  var n3 = Number(parts[3]);\n  return n0 >= 0 && n0 < 256 && n1 >= 0 && n1 < 256 && n2 >= 0 && n2 < 256 && n3 >= 0 && n3 < 256;\n}\n\nfunction validate6(input) {\n  var withoutSubnet = input.replace(reSubnetString, '');\n  var hasSubnet = input.length !== withoutSubnet.length; // FIXME: this should probably be an option in the future\n\n  if (hasSubnet) return false;\n\n  if (!hasSubnet) {\n    if (reForwardSlash.test(input)) return false;\n  }\n\n  var withoutZone = withoutSubnet.replace(reZone, '');\n  var lastPartSeparator = withoutZone.lastIndexOf(':');\n  if (lastPartSeparator === -1) return false;\n  var lastPart = withoutZone.substring(lastPartSeparator + 1);\n  var hasV4Part = validate4(lastPart);\n  var address = hasV4Part ? withoutZone.substring(0, lastPartSeparator + 1) + '1234:5678' : withoutZone;\n  if (reBadCharacters.test(address)) return false;\n  if (reBadAddress.test(address)) return false;\n  var halves = address.split('::');\n  if (halves.length > 2) return false;\n\n  if (halves.length === 2) {\n    var first = halves[0] === '' ? [] : halves[0].split(':');\n    var last = halves[1] === '' ? [] : halves[1].split(':');\n    var remainingLength = 8 - (first.length + last.length);\n    if (remainingLength <= 0) return false;\n  } else {\n    if (address.split(':').length !== 8) return false;\n  }\n\n  return true;\n}\n\nfunction validate(input) {\n  return validate4(input) || validate6(input);\n}\n\nmodule.exports = function validator(options) {\n  if (!options) options = {};\n  if (options.version === 4) return validate4;\n  if (options.version === 6) return validate6;\n  if (options.version == null) return validate;\n  throw new Error('Unknown version: ' + options.version);\n};\n\nmodule.exports['__all_regexes__'] = [reIpv4FirstPass, reSubnetString, reForwardSlash, reZone, reBadCharacters, reBadAddress];","map":null,"metadata":{},"sourceType":"script"}